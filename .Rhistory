setwd("~/GitHub/prospectus-draft")
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
source('~/GitHub/prospectus-draft/R/helpers.R')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 3) +
theme_clean() +
geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
d
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 3) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 3) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 4) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 4) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
g1 + geom_rect(aes(xmin = .50, xmax = .64, ymin = 0, ymax = Inf))
g1 + geom_rect(aes(xmin = .50, xmax = .64, ymin = 0, ymax = Inf))
g1 + geom_rect(aes(xmin = .50, xmax = .64, ymin = -Inf, ymax = Inf))
g1 + geom_rect(aes(xmin = .51, xmax = .63, ymin = -Inf, ymax = Inf))
g1 + geom_rect(aes(xmin = .51, xmax = .63, ymin = -Inf, ymax = Inf), fill = 'lightgray')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 4) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 4) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
# d <- score_controls(metric='drive')
# saveRDS(d, 'data/score-metric-driving.rds')
d <- readRDS('data/score-metric-driving.rds')
dd <- d %>%
dplyr::slice(1:23) %>%
dplyr::mutate(assignment = 1 - control) %>%
dplyr::select(score, assignment) %>%
dplyr::mutate(`Double Up` = dplyr::if_else(assignment == 1, 'Yes', 'No'))
g1 <- ggplot2::ggplot(data = dd) +
ggplot2::geom_point(aes(x = score, y = assignment, colour = `Double Up`), size = 3) +
theme_clean()
g1 + geom_vline(aes(xintercept = .57), color = 'blue', linetype = 'dashed')
if(getOutputFormat() == "latex") pdf_yes = TRUE else pdf_yes = FALSE
pdf_yes = FALSE
# set up text
raw <- function(x) knitr::asis_output(x)
a <- list()
a[[1]] <- ("```{r dufb-expansion, fig.cap = 'Example expansion over time from 2014 to 2016 (top to bottom) using fake data. Blue dots denote stores with Double Up, pink dots denote without. Gray sectors denote higher population density. The initial nodes can be seen in the top (2014) frame.', fig.align='center', echo=FALSE}")
a[[2]] <- ("knitr::include_graphics('figures/expansion-v.pdf')")
if(!pdf_yes) a[[2]] <- gsub('pdf', 'png', a[[2]])
a[[3]] <- ("```")
out <- paste(a, collapse = '\n')
out
raw(paste(knitr::knit(text = paste(out), quiet = TRUE)))
paste(knitr::knit(text = paste(out), quiet = TRUE))
out
# MUST paste the output. cannot just knit!
raw(paste(knitr::knit(text = paste(out), quiet = TRUE)))
if(getOutputFormat() == "latex") pdf_yes = TRUE else pdf_yes = FALSE
# MUST paste the output. cannot just knit!
raw(paste(knitr::knit(text = paste(out), quiet = TRUE)))
if(getOutputFormat() == "latex") knitr::asis_output("#")
knitr::asis_output("#")
source('~/GitHub/prospectus-draft/R/DD.R')
DD1()
source('~/GitHub/prospectus-draft/R/DD.R')
DD1()
source('~/GitHub/prospectus-draft/R/DD.R')
source('~/GitHub/prospectus-draft/R/DD.R')
DD1()
source('~/GitHub/prospectus-draft/R/DD.R')
DD1()
source('~/GitHub/prospectus-draft/R/DD.R')
source('~/GitHub/prospectus-draft/R/DD.R')
DD1()
source('~/GitHub/prospectus-draft/R/DD.R')
DD1()
